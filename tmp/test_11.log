test_11_file_upload_operations (_UNITTEST.test_gds.GDSTest.test_11_file_upload_operations)
测试文件上传操作 ... ok

----------------------------------------------------------------------
Ran 1 test in 516.874s

OK
🚀 设置GDS全面测试环境...
📁 远端测试目录: ~/tmp/gds_test_20250829_015820_202391_65c0c60f
✅ 已切换到远端测试目录: ~/tmp/gds_test_20250829_015820_202391_65c0c60f
📁 本地临时目录: /var/folders/w0/m02j_xv925sg34708rb2xgzr0000gn/T/gds_test_local_x687o413
✅ 测试环境设置完成

🧪 测试11: 文件上传操作

🔄 执行带重试的命令: upload --force /Users/wukunhuan/.local/bin/_UNITTEST/_TEMP/test03_simple_hello.py
🔍 验证命令: ['ls test03_simple_hello.py']
🎯 最大重试次数: 3

📍 尝试 1/3

🔧 执行命令: upload --force /Users/wukunhuan/.local/bin/_UNITTEST/_TEMP/test03_simple_hello.py
📤 返回码: 0
📝 输出: ⏳ Waiting for upload .........√
⏳ Waiting for result .......√
⏳ Validating test03_simple_hello.py ...√
Upload completed: 1/1 files
...
  🔍 验证 1/1: ls test03_simple_hello.py

🔧 执行命令: ls test03_simple_hello.py
📤 返回码: 1
📝 输出: Failed to list files: Path not found: test03_simple_hello.py
...
  ❌ 验证失败，返回码: 1
⏳ 验证失败，等待2秒后重试...

📍 尝试 2/3

🔧 执行命令: upload --force /Users/wukunhuan/.local/bin/_UNITTEST/_TEMP/test03_simple_hello.py
📤 返回码: 0
📝 输出: ⏳ Waiting for upload .........√
⏳ Waiting for result .........√
⏳ Validating test03_simple_hello.py ...√
Upload completed: 1/1 files
...
  🔍 验证 1/1: ls test03_simple_hello.py

🔧 执行命令: ls test03_simple_hello.py
📤 返回码: 0
📝 输出: test03_simple_hello.py
...
  ✅ 验证成功
🎉 所有验证通过，命令成功执行

🔄 执行带重试的命令: upload --force /Users/wukunhuan/.local/bin/_UNITTEST/_DATA/valid_script.py /Users/wukunhuan/.local/bin/_UNITTEST/_DATA/special_chars.txt
🔍 验证命令: ['ls valid_script.py', 'ls special_chars.txt']
🎯 最大重试次数: 3

📍 尝试 1/3

🔧 执行命令: upload --force /Users/wukunhuan/.local/bin/_UNITTEST/_DATA/valid_script.py /Users/wukunhuan/.local/bin/_UNITTEST/_DATA/special_chars.txt
📤 返回码: 0
📝 输出: ⏳ Waiting for upload ..........√
⏳ Waiting for result ......√
⏳ Validating valid_script.py, special_chars.txt ...√√
Upload completed: 2/2 files
...
  🔍 验证 1/2: ls valid_script.py

🔧 执行命令: ls valid_script.py
📤 返回码: 0
📝 输出: valid_script.py
...
  ✅ 验证成功
  🔍 验证 2/2: ls special_chars.txt

🔧 执行命令: ls special_chars.txt
📤 返回码: 0
📝 输出: special_chars.txt
...
  ✅ 验证成功
🎉 所有验证通过，命令成功执行

🔄 执行带重试的命令: upload-folder --force /Users/wukunhuan/.local/bin/_UNITTEST/_DATA/test_project
🔍 验证命令: ['ls test_project']
🎯 最大重试次数: 3

📍 尝试 1/3

🔧 执行命令: upload-folder --force /Users/wukunhuan/.local/bin/_UNITTEST/_DATA/test_project
📤 返回码: 0
📝 输出: Packing test_project ... √
⏳ Waiting for upload ..........√
⏳ Waiting for result ......√
Folder upload detected, skipping file verification
📝 Added deletion record for original: test_project.zip
Uploa...
  🔍 验证 1/1: ls test_project

🔧 执行命令: ls test_project
📤 返回码: 1
📝 输出: Failed to list files: Path not found: test_project
...
  ❌ 验证失败，返回码: 1
⏳ 验证失败，等待2秒后重试...

📍 尝试 2/3

🔧 执行命令: upload-folder --force /Users/wukunhuan/.local/bin/_UNITTEST/_DATA/test_project
📤 返回码: 0
📝 输出: Packing test_project ... √
⏳ Waiting for upload .........√
⏳ Waiting for result .......√
Folder upload detected, skipping file verification
📝 Added deletion record for original: test_project.zip
📝 Add...
  🔍 验证 1/1: ls test_project

🔧 执行命令: ls test_project
📤 返回码: 0
📝 输出: config.json
core.py
main.py
...
  ✅ 验证成功
🎉 所有验证通过，命令成功执行

🔄 执行带重试的命令: upload --force /Users/wukunhuan/.local/bin/_UNITTEST/_TEMP/test03_conflict_file.py
🔍 验证命令: ['ls test03_conflict_file.py']
🎯 最大重试次数: 3

📍 尝试 1/3

🔧 执行命令: upload --force /Users/wukunhuan/.local/bin/_UNITTEST/_TEMP/test03_conflict_file.py
📤 返回码: 0
📝 输出: ⏳ Waiting for upload .........√
⏳ Waiting for result ......√
⏳ Validating test03_conflict_file.py ...√
Upload completed: 1/1 files
...
  🔍 验证 1/1: ls test03_conflict_file.py

🔧 执行命令: ls test03_conflict_file.py
📤 返回码: 0
📝 输出: test03_conflict_file.py
...
  ✅ 验证成功
🎉 所有验证通过，命令成功执行

🔧 执行命令: upload /Users/wukunhuan/.local/bin/_UNITTEST/_TEMP/test03_conflict_file.py
📤 返回码: 1
📝 输出: ⏳ Waiting for upload ...
File exists: test03_conflict_file.py. Use --force to override.
...
✅ 验证没有--force时上传已存在文件失败

🔄 执行带重试的命令: upload --force /Users/wukunhuan/.local/bin/_UNITTEST/_TEMP/test03_overwrite_file.py
🔍 验证命令: ['ls test03_overwrite_file.py']
🎯 最大重试次数: 3

📍 尝试 1/3

🔧 执行命令: upload --force /Users/wukunhuan/.local/bin/_UNITTEST/_TEMP/test03_overwrite_file.py
📤 返回码: 0
📝 输出: ⏳ Waiting for upload .........√
⏳ Waiting for result .......√
⏳ Validating test03_overwrite_file.py ...√
Upload completed: 1/1 files
...
  🔍 验证 1/1: ls test03_overwrite_file.py

🔧 执行命令: ls test03_overwrite_file.py
📤 返回码: 0
📝 输出: test03_overwrite_file.py
...
  ✅ 验证成功
🎉 所有验证通过，命令成功执行

🔧 执行命令: cat test03_overwrite_file.py
📤 返回码: 0
📝 输出: print("ORIGINAL VERSION - Test upload")
...

🔄 执行带重试的命令: upload --force /Users/wukunhuan/.local/bin/_UNITTEST/_TEMP/test03_overwrite_file.py
🔍 验证命令: ['grep "MODIFIED VERSION" test03_overwrite_file.py']
🎯 最大重试次数: 3

📍 尝试 1/3

🔧 执行命令: upload --force /Users/wukunhuan/.local/bin/_UNITTEST/_TEMP/test03_overwrite_file.py
📤 返回码: 0
📝 输出: ⏳ Waiting for upload .........√
⏳ Waiting for result ........√
⏳ Validating test03_overwrite_file.py ...√
Upload completed: 1/1 files
...
  🔍 验证 1/1: grep "MODIFIED VERSION" test03_overwrite_file.py

🔧 执行命令: grep "MODIFIED VERSION" test03_overwrite_file.py
📤 返回码: 0
📝 输出:   1: print("MODIFIED VERSION - Test upload overwrite!")
...
  ✅ 验证成功
🎉 所有验证通过，命令成功执行

🔧 执行命令: cat test03_overwrite_file.py
📤 返回码: 0
📝 输出: print("MODIFIED VERSION - Test upload overwrite!")
...
✅ 验证upload --force覆盖功能，文件内容确实被修改

🔄 执行带重试的命令: upload-folder --force /Users/wukunhuan/.local/bin/_UNITTEST/_DATA/empty_test_dir
🔍 验证命令: ['ls empty_test_dir']
🎯 最大重试次数: 3

📍 尝试 1/3

🔧 执行命令: upload-folder --force /Users/wukunhuan/.local/bin/_UNITTEST/_DATA/empty_test_dir
📤 返回码: 0
📝 输出: Packing empty_test_dir ... √
⏳ Waiting for upload .........√
⏳ Waiting for result ........√
Folder upload detected, skipping file verification
📝 Added deletion record for original: empty_test_dir.zip
...
  🔍 验证 1/1: ls empty_test_dir

🔧 执行命令: ls empty_test_dir
📤 返回码: 0
  ✅ 验证成功
🎉 所有验证通过，命令成功执行
